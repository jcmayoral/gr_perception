<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GrassRobotics Common: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GrassRobotics Common
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>**WARNING: This repository has gone stale as I unfortunately do not have the time to maintain it anymore. If you would like to continue the development of it as a collaborator send me an email at <a href="#" onclick="location.href='mai'+'lto:'+'eri'+'kl'+'ind'+'er'+'nor'+'en'+'@gm'+'ai'+'l.c'+'om'; return false;">erikl<span style="display: none;">.nosp@m.</span>inde<span style="display: none;">.nosp@m.</span>rnore<span style="display: none;">.nosp@m.</span>n@gm<span style="display: none;">.nosp@m.</span>ail.c<span style="display: none;">.nosp@m.</span>om</a>.**</p>
<h1>PyTorch-YOLOv3</h1>
<p>A minimal PyTorch implementation of YOLOv3, with support for training, inference and evaluation.</p>
<h2>Installation</h2>
<h5>Clone and install requirements</h5>
<p>$ git clone <a href="https://github.com/eriklindernoren/PyTorch-YOLOv3">https://github.com/eriklindernoren/PyTorch-YOLOv3</a> $ cd PyTorch-YOLOv3/ $ sudo pip3 install -r requirements.txt</p>
<h5>Download pretrained weights</h5>
<p>$ cd weights/ $ bash download_weights.sh</p>
<h5>Download COCO</h5>
<p>$ cd data/ $ bash get_coco_dataset.sh</p>
<h2>Test</h2>
<p>Evaluates the model on COCO test. </p><pre class="fragment">$ python3 test.py --weights_path weights/yolov3.weights
</pre><table class="doxtable">
<tr>
<th>Model </th><th align="center">mAP (min. 50 IoU)  </th></tr>
<tr>
<td>YOLOv3 608 (paper) </td><td align="center">57.9 </td></tr>
<tr>
<td>YOLOv3 608 (this impl.) </td><td align="center">57.3 </td></tr>
<tr>
<td>YOLOv3 416 (paper) </td><td align="center">55.3 </td></tr>
<tr>
<td>YOLOv3 416 (this impl.) </td><td align="center">55.5 </td></tr>
</table>
<h2>Inference</h2>
<p>Uses pretrained weights to make predictions on images. Below table displays the inference times when using as inputs images scaled to 256x256. The ResNet backbone measurements are taken from the YOLOv3 paper. The Darknet-53 measurement marked shows the inference time of this implementation on my 1080ti card.</p>
<table class="doxtable">
<tr>
<th>Backbone </th><th align="center">GPU </th><th align="center">FPS  </th></tr>
<tr>
<td>ResNet-101 </td><td align="center">Titan X </td><td align="center">53 </td></tr>
<tr>
<td>ResNet-152 </td><td align="center">Titan X </td><td align="center">37 </td></tr>
<tr>
<td>Darknet-53 (paper) </td><td align="center">Titan X </td><td align="center">76 </td></tr>
<tr>
<td>Darknet-53 (this impl.) </td><td align="center">1080ti </td><td align="center">74 </td></tr>
</table>
<pre class="fragment">$ python3 detect.py --image_folder data/samples/
</pre><p>&lt;img src="assets/giraffe.png" width="480"&gt;</p>
<p>&lt;img src="assets/dog.png" width="480"&gt;</p>
<p>&lt;img src="assets/traffic.png" width="480"&gt;</p>
<p>&lt;img src="assets/messi.png" width="480"&gt;</p>
<p>## Train </p><div class="fragment"><div class="line">$ train.py [-h] [--epochs EPOCHS] [--batch_size BATCH_SIZE]</div><div class="line">                [--gradient_accumulations GRADIENT_ACCUMULATIONS]</div><div class="line">                [--model_def MODEL_DEF] [--data_config DATA_CONFIG]</div><div class="line">                [--pretrained_weights PRETRAINED_WEIGHTS] [--n_cpu N_CPU]</div><div class="line">                [--img_size IMG_SIZE]</div><div class="line">                [--checkpoint_interval CHECKPOINT_INTERVAL]</div><div class="line">                [--evaluation_interval EVALUATION_INTERVAL]</div><div class="line">                [--compute_map COMPUTE_MAP]</div><div class="line">                [--multiscale_training MULTISCALE_TRAINING]</div></div><!-- fragment --><h4>Example (COCO)</h4>
<p>To train on COCO using a Darknet-53 backend pretrained on ImageNet run: </p><div class="fragment"><div class="line">$ python3 train.py --data_config config/coco.data  --pretrained_weights weights/darknet53.conv.74</div></div><!-- fragment --><p>#### Training log </p><div class="fragment"><div class="line">---- [Epoch 7/100, Batch 7300/14658] ----</div><div class="line">+------------+--------------+--------------+--------------+</div><div class="line">| Metrics    | YOLO Layer 0 | YOLO Layer 1 | YOLO Layer 2 |</div><div class="line">+------------+--------------+--------------+--------------+</div><div class="line">| grid_size  | 16           | 32           | 64           |</div><div class="line">| loss       | 1.554926     | 1.446884     | 1.427585     |</div><div class="line">| x          | 0.028157     | 0.044483     | 0.051159     |</div><div class="line">| y          | 0.040524     | 0.035687     | 0.046307     |</div><div class="line">| w          | 0.078980     | 0.066310     | 0.027984     |</div><div class="line">| h          | 0.133414     | 0.094540     | 0.037121     |</div><div class="line">| conf       | 1.234448     | 1.165665     | 1.223495     |</div><div class="line">| cls        | 0.039402     | 0.040198     | 0.041520     |</div><div class="line">| cls_acc    | 44.44%       | 43.59%       | 32.50%       |</div><div class="line">| recall50   | 0.361111     | 0.384615     | 0.300000     |</div><div class="line">| recall75   | 0.222222     | 0.282051     | 0.300000     |</div><div class="line">| precision  | 0.520000     | 0.300000     | 0.070175     |</div><div class="line">| conf_obj   | 0.599058     | 0.622685     | 0.651472     |</div><div class="line">| conf_noobj | 0.003778     | 0.004039     | 0.004044     |</div><div class="line">+------------+--------------+--------------+--------------+</div><div class="line">Total Loss 4.429395</div><div class="line">---- ETA 0:35:48.821929</div></div><!-- fragment --><h4>Tensorboard</h4>
<p>Track training progress in Tensorboard:</p><ul>
<li>Initialize training</li>
<li>Run the command below</li>
<li>Go to <a href="http://localhost:6006/">http://localhost:6006/</a></li>
</ul>
<div class="fragment"><div class="line">$ tensorboard --logdir=&#39;logs&#39; --port=6006</div></div><!-- fragment --><p>Storing the logs on a slow drive possibly leads to a significant training speed decrease.</p>
<p>You can adjust the log directory using <code>--logdir &lt;path&gt;</code> when running <code>tensorboard</code> or the <code>train.py</code>.</p>
<h2>Train on Custom Dataset</h2>
<h4>Custom model</h4>
<p>Run the commands below to create a custom model definition, replacing <code>&lt;num-classes&gt;</code> with the number of classes in your dataset.</p>
<div class="fragment"><div class="line">$ cd config/                                # Navigate to config dir</div><div class="line">$ bash create_custom_model.sh &lt;num-classes&gt; # Will create custom model &#39;yolov3-custom.cfg&#39;</div></div><!-- fragment --><h4>Classes</h4>
<p>Add class names to <code>data/custom/classes.names</code>. This file should have one row per class name.</p>
<h4>Image Folder</h4>
<p>Move the images of your dataset to <code>data/custom/images/</code>.</p>
<h4>Annotation Folder</h4>
<p>Move your annotations to <code>data/custom/labels/</code>. The dataloader expects that the annotation file corresponding to the image <code>data/custom/images/train.jpg</code> has the path <code>data/custom/labels/train.txt</code>. Each row in the annotation file should define one bounding box, using the syntax <code>label_idx x_center y_center width height</code>. The coordinates should be scaled <code>[0, 1]</code>, and the <code>label_idx</code> should be zero-indexed and correspond to the row number of the class name in <code>data/custom/classes.names</code>.</p>
<h4>Define Train and Validation Sets</h4>
<p>In <code>data/custom/train.txt</code> and <code>data/custom/valid.txt</code>, add paths to images that will be used as train and validation data respectively.</p>
<h4>Train</h4>
<p>To train on the custom dataset run:</p>
<div class="fragment"><div class="line">$ python3 train.py --model_def config/yolov3-custom.cfg --data_config config/custom.data</div></div><!-- fragment --><p>Add <code>--pretrained_weights weights/darknet53.conv.74</code> to train using a backend pretrained on ImageNet.</p>
<h2>Credit</h2>
<h3>YOLOv3: An Incremental Improvement</h3>
<p><em>Joseph Redmon, Ali Farhadi</em> <br />
</p>
<p><b>Abstract</b> <br />
 We present some updates to YOLO! We made a bunch of little design changes to make it better. We also trained this new network that’s pretty swell. It’s a little bigger than last time but more accurate. It’s still fast though, don’t worry. At 320 × 320 YOLOv3 runs in 22 ms at 28.2 mAP, as accurate as SSD but three times faster. When we look at the old .5 IOU mAP detection metric YOLOv3 is quite good. It achieves 57.9 AP50 in 51 ms on a Titan X, compared to 57.5 AP50 in 198 ms by RetinaNet, similar performance but 3.8× faster. As always, all the code is online at <a href="https://pjreddie.com/yolo/">https://pjreddie.com/yolo/</a>.</p>
<p><a href="https://pjreddie.com/media/files/papers/YOLOv3.pdf">[Paper]</a> <a href="https://pjreddie.com/darknet/yolo/">[Project Webpage]</a> <a href="https://github.com/pjreddie/darknet">[Authors' Implementation]</a></p>
<div class="fragment"><div class="line">@article{yolov3,</div><div class="line">  title={YOLOv3: An Incremental Improvement},</div><div class="line">  author={Redmon, Joseph and Farhadi, Ali},</div><div class="line">  journal = {arXiv},</div><div class="line">  year={2018}</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
